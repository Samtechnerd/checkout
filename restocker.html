<!DOCTYPE html>
<html>
<head>
    <title>Hello. Restocker</title>
    <script src="https://unpkg.com/html5-qrcode"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <style>
        body { font-family: Arial; padding: 20px; background: #f3f3f3; }
        .box { background: white; padding: 20px; border-radius: 12px; max-width: 600px; margin: auto; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        input { width: 100%; padding: 12px; margin: 10px 0; border-radius: 8px; border: 1px solid #ccc; box-sizing: border-box; }
        .btn { background: #00539f; color: white; border: none; padding: 15px; width: 100%; border-radius: 30px; cursor: pointer; font-weight: bold; }
        #reader { width: 100%; height: 250px; background: #000; margin-bottom: 10px; border-radius: 8px; overflow: hidden; }
    </style>
</head>
<body>
    <div class="box">
        <h2 style="color:#00539f">Product & Staff Manager</h2>
        <div id="reader"></div>
        <input type="text" id="bc" placeholder="Barcode ID (Scan or type)">
        <input type="text" id="nm" placeholder="Name">
        <input type="number" id="pr" placeholder="Price (£)" step="0.01">
        <button class="btn" onclick="save('inventory')">Add Product</button>
        <button class="btn" style="background:#555; margin-top:10px;" onclick="save('staff')">Add as Staff Card</button>
        
        <hr>
        <h3>Live Inventory</h3>
        <div id="live-list"></div>
    </div>

    <script>
        const firebaseConfig = { apiKey: "AIzaSyAXtjM56OQso8g3RauOkT3h1ommplCelyE", authDomain: "checkout-c52ab.firebaseapp.com", projectId: "checkout-c52ab", storageBucket: "checkout-c52ab.firebasestorage.app", messagingSenderId: "486554411560", appId: "1:486554411560:web:9d24b172a86cfe1b2c0b1d" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Start Scanner
        const html5QrCode = new Html5Qrcode("reader");
        html5QrCode.start({ facingMode: "environment" }, { fps: 10, qrbox: 250 }, (code) => {
            document.getElementById('bc').value = code;
        });

        async function save(type) {
            const id = document.getElementById('bc').value;
            const name = document.getElementById('nm').value;
            const price = document.getElementById('pr').value;
            
            await db.collection(type).doc(id).set({
                id: id,
                name: name,
                price: parseFloat(price || 0)
            });
            alert("Saved to " + type);
        }

        // Live list listener
        db.collection("inventory").onSnapshot(snap => {
            document.getElementById('live-list').innerHTML = snap.docs.map(doc => 
                `<p>${doc.data().name} - £${doc.data().price} (ID: ${doc.id})</p>`
            ).join('');
        });
    </script>
</body>
</html>
